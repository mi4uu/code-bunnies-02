# Crate Documentation

**Version:** 0.3.31

**Format Version:** 43

# Module `futures`

Abstractions for asynchronous programming.

This crate provides a number of core abstractions for writing asynchronous
code:

- [Futures](crate::future) are single eventual values produced by
  asynchronous computations. Some programming languages (e.g. JavaScript)
  call this concept "promise".
- [Streams](crate::stream) represent a series of values
  produced asynchronously.
- [Sinks](crate::sink) provide support for asynchronous writing of
  data.
- [Executors](crate::executor) are responsible for running asynchronous
  tasks.

The crate also contains abstractions for [asynchronous I/O](crate::io) and
[cross-task communication](crate::channel).

Underlying all of this is the *task system*, which is a form of lightweight
threading. Large asynchronous computations are built up using futures,
streams and sinks, and then spawned as independent tasks that are run to
completion, but *do not block* the thread running them.

The following example describes how the task system context is built and used
within macros and keywords such as async and await!.

```rust
# use futures::channel::mpsc;
# use futures::executor; ///standard executors to provide a context for futures and streams
# use futures::executor::ThreadPool;
# use futures::StreamExt;
#
fn main() {
    # {
    let pool = ThreadPool::new().expect("Failed to build pool");
    let (tx, rx) = mpsc::unbounded::<i32>();

    // Create a future by an async block, where async is responsible for an
    // implementation of Future. At this point no executor has been provided
    // to this future, so it will not be running.
    let fut_values = async {
        // Create another async block, again where the Future implementation
        // is generated by async. Since this is inside of a parent async block,
        // it will be provided with the executor of the parent block when the parent
        // block is executed.
        //
        // This executor chaining is done by Future::poll whose second argument
        // is a std::task::Context. This represents our executor, and the Future
        // implemented by this async block can be polled using the parent async
        // block's executor.
        let fut_tx_result = async move {
            (0..100).for_each(|v| {
                tx.unbounded_send(v).expect("Failed to send");
            })
        };

        // Use the provided thread pool to spawn the generated future
        // responsible for transmission
        pool.spawn_ok(fut_tx_result);

        let fut_values = rx
            .map(|v| v * 2)
            .collect();

        // Use the executor provided to this async block to wait for the
        // future to complete.
        fut_values.await
    };

    // Actually execute the above future, which will invoke Future::poll and
    // subsequently chain appropriate Future::poll and methods needing executors
    // to drive all futures. Eventually fut_values will be driven to completion.
    let values: Vec<i32> = executor::block_on(fut_values);

    println!("Values={:?}", values);
    # }
    # std::thread::sleep(std::time::Duration::from_millis(500)); // wait for background threads closed: https://github.com/rust-lang/miri/issues/1371
}
```

The majority of examples and code snippets in this crate assume that they are
inside an async block as written above.

## Modules

## Module `executor`

**Attributes:**

- `#[<cfg>(feature = "executor")]`
- `#[<cfg_attr>(docsrs, doc(cfg(feature = "executor")))]`

Built-in executors and related tools.

All asynchronous computation occurs within an executor, which is
capable of spawning futures as tasks. This module provides several
built-in executors, as well as tools for building your own.


This module is only available when the `executor` feature of this
library is activated.

# Using a thread pool (M:N task scheduling)

Most of the time tasks should be executed on a [thread pool](ThreadPool).
A small set of worker threads can handle a very large set of spawned tasks
(which are much lighter weight than threads). Tasks spawned onto the pool
with the [`spawn_ok`](ThreadPool::spawn_ok) function will run ambiently on
the created threads.

# Spawning additional tasks

Tasks can be spawned onto a spawner by calling its [`spawn_obj`] method
directly. In the case of `!Send` futures, [`spawn_local_obj`] can be used
instead.

# Single-threaded execution

In addition to thread pools, it's possible to run a task (and the tasks
it spawns) entirely within a single thread via the [`LocalPool`] executor.
Aside from cutting down on synchronization costs, this executor also makes
it possible to spawn non-`Send` tasks, via [`spawn_local_obj`]. The
[`LocalPool`] is best suited for running I/O-bound tasks that do relatively
little work between I/O operations.

There is also a convenience function [`block_on`] for simply running a
future to completion on the current thread.

[`spawn_obj`]: https://docs.rs/futures/0.3/futures/task/trait.Spawn.html#tymethod.spawn_obj
[`spawn_local_obj`]: https://docs.rs/futures/0.3/futures/task/trait.LocalSpawn.html#tymethod.spawn_local_obj

```rust
pub mod executor { /* ... */ }
```

### Re-exports

#### Re-export `block_on`

```rust
pub use futures_executor::block_on;
```

#### Re-export `block_on_stream`

```rust
pub use futures_executor::block_on_stream;
```

#### Re-export `enter`

```rust
pub use futures_executor::enter;
```

#### Re-export `BlockingStream`

```rust
pub use futures_executor::BlockingStream;
```

#### Re-export `Enter`

```rust
pub use futures_executor::Enter;
```

#### Re-export `EnterError`

```rust
pub use futures_executor::EnterError;
```

#### Re-export `LocalPool`

```rust
pub use futures_executor::LocalPool;
```

#### Re-export `LocalSpawner`

```rust
pub use futures_executor::LocalSpawner;
```

## Module `prelude`

A "prelude" for crates using the `futures` crate.

This prelude is similar to the standard library's prelude in that you'll
almost always want to import its entire contents, but unlike the
standard library's prelude you'll have to do so manually:

```
# #[allow(unused_imports)]
use futures::prelude::*;
```

The prelude may grow over time as additional items see ubiquitous use.

```rust
pub mod prelude { /* ... */ }
```

### Re-exports

#### Re-export `future`

```rust
pub use crate::future;
```

#### Re-export `Future`

```rust
pub use crate::future::Future;
```

#### Re-export `TryFuture`

```rust
pub use crate::future::TryFuture;
```

#### Re-export `sink`

```rust
pub use crate::sink;
```

#### Re-export `Sink`

```rust
pub use crate::sink::Sink;
```

#### Re-export `stream`

```rust
pub use crate::stream;
```

#### Re-export `Stream`

```rust
pub use crate::stream::Stream;
```

#### Re-export `TryStream`

```rust
pub use crate::stream::TryStream;
```

#### Re-export `FutureExt`

**Attributes:**

- `#[doc(no_inline)]`
- `#[allow(unreachable_pub)]`

```rust
pub use crate::future::FutureExt as _;
```

#### Re-export `TryFutureExt`

**Attributes:**

- `#[doc(no_inline)]`
- `#[allow(unreachable_pub)]`

```rust
pub use crate::future::TryFutureExt as _;
```

#### Re-export `SinkExt`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use crate::sink::SinkExt as _;
```

#### Re-export `StreamExt`

**Attributes:**

- `#[doc(no_inline)]`
- `#[allow(unreachable_pub)]`

```rust
pub use crate::stream::StreamExt as _;
```

#### Re-export `TryStreamExt`

**Attributes:**

- `#[doc(no_inline)]`
- `#[allow(unreachable_pub)]`

```rust
pub use crate::stream::TryStreamExt as _;
```

#### Re-export `AsyncBufRead`

**Attributes:**

- `#[<cfg>(feature = "std")]`

```rust
pub use crate::io::AsyncBufRead;
```

#### Re-export `AsyncRead`

**Attributes:**

- `#[<cfg>(feature = "std")]`

```rust
pub use crate::io::AsyncRead;
```

#### Re-export `AsyncSeek`

**Attributes:**

- `#[<cfg>(feature = "std")]`

```rust
pub use crate::io::AsyncSeek;
```

#### Re-export `AsyncWrite`

**Attributes:**

- `#[<cfg>(feature = "std")]`

```rust
pub use crate::io::AsyncWrite;
```

#### Re-export `AsyncBufReadExt`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`
- `#[allow(unreachable_pub)]`

```rust
pub use crate::io::AsyncBufReadExt as _;
```

#### Re-export `AsyncReadExt`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`
- `#[allow(unreachable_pub)]`

```rust
pub use crate::io::AsyncReadExt as _;
```

#### Re-export `AsyncSeekExt`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`
- `#[allow(unreachable_pub)]`

```rust
pub use crate::io::AsyncSeekExt as _;
```

#### Re-export `AsyncWriteExt`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`
- `#[allow(unreachable_pub)]`

```rust
pub use crate::io::AsyncWriteExt as _;
```

## Re-exports

### Re-export `Future`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_core::future::Future;
```

### Re-export `TryFuture`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_core::future::TryFuture;
```

### Re-export `FutureExt`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_util::future::FutureExt;
```

### Re-export `TryFutureExt`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_util::future::TryFutureExt;
```

### Re-export `Stream`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_core::stream::Stream;
```

### Re-export `TryStream`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_core::stream::TryStream;
```

### Re-export `StreamExt`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_util::stream::StreamExt;
```

### Re-export `TryStreamExt`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_util::stream::TryStreamExt;
```

### Re-export `Sink`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_sink::Sink;
```

### Re-export `SinkExt`

**Attributes:**

- `#[doc(no_inline)]`

```rust
pub use futures_util::sink::SinkExt;
```

### Re-export `AsyncBufRead`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`

```rust
pub use futures_io::AsyncBufRead;
```

### Re-export `AsyncRead`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`

```rust
pub use futures_io::AsyncRead;
```

### Re-export `AsyncSeek`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`

```rust
pub use futures_io::AsyncSeek;
```

### Re-export `AsyncWrite`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`

```rust
pub use futures_io::AsyncWrite;
```

### Re-export `AsyncBufReadExt`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`

```rust
pub use futures_util::AsyncBufReadExt;
```

### Re-export `AsyncReadExt`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`

```rust
pub use futures_util::AsyncReadExt;
```

### Re-export `AsyncSeekExt`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`

```rust
pub use futures_util::AsyncSeekExt;
```

### Re-export `AsyncWriteExt`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(no_inline)]`

```rust
pub use futures_util::AsyncWriteExt;
```

### Re-export `ready`

```rust
pub use futures_core::ready;
```

### Re-export `pin_mut`

```rust
pub use futures_util::pin_mut;
```

### Re-export `select`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[<cfg>(feature = "async-await")]`

```rust
pub use futures_util::select;
```

### Re-export `join`

**Attributes:**

- `#[<cfg>(feature = "async-await")]`

```rust
pub use futures_util::join;
```

### Re-export `pending`

**Attributes:**

- `#[<cfg>(feature = "async-await")]`

```rust
pub use futures_util::pending;
```

### Re-export `poll`

**Attributes:**

- `#[<cfg>(feature = "async-await")]`

```rust
pub use futures_util::poll;
```

### Re-export `select_biased`

**Attributes:**

- `#[<cfg>(feature = "async-await")]`

```rust
pub use futures_util::select_biased;
```

### Re-export `try_join`

**Attributes:**

- `#[<cfg>(feature = "async-await")]`

```rust
pub use futures_util::try_join;
```

### Re-export `future`

**Attributes:**

- `#[doc(inline)]`

```rust
pub use futures_util::future;
```

### Re-export `never`

**Attributes:**

- `#[doc(inline)]`

```rust
pub use futures_util::never;
```

### Re-export `sink`

**Attributes:**

- `#[doc(inline)]`

```rust
pub use futures_util::sink;
```

### Re-export `stream`

**Attributes:**

- `#[doc(inline)]`

```rust
pub use futures_util::stream;
```

### Re-export `task`

**Attributes:**

- `#[doc(inline)]`

```rust
pub use futures_util::task;
```

### Re-export `stream_select`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[<cfg>(feature = "async-await")]`

```rust
pub use futures_util::stream_select;
```

### Re-export `futures_channel`

**Attributes:**

- `#[<cfg>(feature = "alloc")]`
- `#[doc(inline)]`

```rust
pub use futures_channel as channel;
```

### Re-export `lock`

**Attributes:**

- `#[<cfg>(feature = "alloc")]`
- `#[doc(inline)]`

```rust
pub use futures_util::lock;
```

### Re-export `io`

**Attributes:**

- `#[<cfg>(feature = "std")]`
- `#[doc(inline)]`

```rust
pub use futures_util::io;
```

